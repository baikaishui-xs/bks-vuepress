---
title: axios 发送请求 简写
date: 2022-06-27 11:01:39
permalink: /pages/c0b227/
categories:
  - 《前端》笔记《框架》
  - 1.vue2
tags:
  - 
---
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <!-- 知识点：axios 发送请求 简写 -->

  <button id="btnGET">GET</button>
  <button id="btnPOST">POST</button>

  <script src="sucai/axios.js"></script>
  <script>

    document.querySelector('#btnGET').addEventListener('click', async function () {

      // （1）发送 get 请求
      // 方法：axios.get('请求地址', { 配置项 })
      const { data: res } = await axios.get('http://www.liulongbin.top:3006/api/getbooks', {
        params: { id: 1 }
      })

      console.log(res)

    })

    document.querySelector('#btnPOST').addEventListener('click', async function () {

      // （2）发送 post 请求
      // 方法：axios.post('请求地址', { 默认在 params 对象中 })
      const { data: res } = await axios.post('http://www.liulongbin.top:3006/api/post', { name: 'zs', gender: '女' })

      console.log(res)

    })
  </script>
</body>

</html>

<!-- 
  需求：点击按钮，发送请求 GET 请求
  使用步骤：
  -- Left 组件
    <template>
      <div class="left-container">
          <button @click="getInfo">发起 GET 请求</button>
      </div>
    </template>

    <script>
      import axios from 'axios'

      export default {
        methods: {
          async getInfo() {
            const { data: red } = await axios.get('http://www.liulongbin.top:3006/api/get')
          }
        }
      }
    </script>
-->

<!-- 
  需求：点击按钮，发送请求 POST 请求
  -- Right 组件
    <template>
      <div class="right-container">
          <button @click="postInfo">发起 POST 请求</button>
      </div>
    </template>

    <script>
      import axios from 'axios'

      export default {
        methods: {
          async postInfo() {
            const { data: red } = await axios.post('http://www.liulongbin.top:3006/api/get', { name: 'zs', age: 20})
          }
        }
      }
    </script>
-->

<!-- 
  优化 axios

    问题：传统的方法，在每个组件使用 axios 的时候，都要导入一次 axios，导致 重复率高
      解决方法一：在 main.js 中，将 axios 的导入，放到 Vue 的原型对象上
          import axios from 'axios'
          Vue.prototype.$http = axios
        原理：每个 Vue 组件，都是 Vue 的实例，可以将组件实例公共的部分，放到 Vue 原型对象上
        使用步骤：使用时无需导入 axios，只需要使用 this.$http.请求方式 即可
        如：export default {
            methods: {
              async postInfo() {
                const { data: red } = await this.$http.post('http://www.liulongbin.top:3006/api/get', { name: 'zs', age: 20})
              }
            }
          }
        缺点：这种放到原型对象上的方法有一个缺点，就是 无法实现API接口的复用
        如：在 Left 组件中写了一个 点击按钮获取图书列表数据的功能，在 Right 组件中还要在写一次，无法复用这个功能
          -- Left 组件
            <template>
              <div class="left-container">
                  <button @click="btnGetBooks">获取图书列表数据</button>
              </div>
            </template>

            <script>
              export default {
                methods: {
                  async btnGetBooks() {
                    const { data: res } = await this.$http.get('http://www.liulongbin.top:3006/api/get')
                  }
                }
              }
            </script>

          -- Right 组件
            <template>
              <div class="right-container">
                  <button @click="btnGetBooks">获取图书列表数据</button>
              </div>
            </template>

            <script>
              export default {
                methods: {
                  async btnGetBooks() {
                    const { data: res } = await this.$http.get('http://www.liulongbin.top:3006/api/get')
                  }
                }
              }
            </script>
      
      解决方法二：vue-router，该方法只能在 Vue 项目中使用

    问题：传统的方法，在每个组件使用请求地址的时候，都要写一次根路径，并且后端如果把根路径该了，还有手动一个个修改，导致 维护性差，重复率高
      解决方法：在 main.js 中配置 请求根路径
        语法：axios.defaults.baseURL = '请求根路径'
        如：axios.defaults.baseURL = 'http://www.liulongbin.top:3006'
      使用步骤：在使用时，不需要写根路径
        如：const { data: red } = await this.$http.post('api/get', { name: 'zs', age: 20})

      解决方法三（推荐）：封装 request 模块
      使用步骤：在 src 目录下创建 utils 目录（存放工具性质的函数和模块），然后在创建 request.js，并配置以下内容
        （1）封装 request 模块
        （2）封装 request 的方法
        （3）调用 request 方法
        （4）查看是否请求成功

      -- request.js

        （1）封装 request 模块
        import axios from 'axios'
        const request = axios.create({  // 创建 axios 实例对象
          baseURL: 'https://www.escook.cn'  // 指定请求根路径
          timeout: 8000,  // 超时时间
        })
        export default request
      
      -- 组件.vue
        
        export default {

          created() {  // （3）调佣 request 方法
            this.initArticleList()
          }

          methods: {

            （2）封装 request 的方法
            规范：在封装获取数据方法时，方法名前面统一加上 init
            async initArticleList() {
              const {data: res} = request.get('/articles', {
                params: {
                  _page: this.page,
                  _limit: this.limit
                }
              })
              console.log(res)  // （4）查看是否请求成功
            }

          }
        }
-->