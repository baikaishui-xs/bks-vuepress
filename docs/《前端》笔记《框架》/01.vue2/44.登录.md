---
title: 登录
date: 2022-06-27 11:01:39
permalink: /pages/e590af/
categories:
  - 《前端》笔记《框架》
  - 1.vue2
tags:
  - 
---
**作用：** 因为 http 是无状态的，所以需要记录用户的登录状态

##  一、常见的维持登录状态的方案

  ## （一）cookie
  **特性：** 在客户端记录状态

  **应用场景：** 不存在跨域问题

  ## （二）session
  **特性：** 在服务器端记录状态

  **应用场景：** 不存在跨域问题

  ## （二）token
  **应用场景：** 存在跨域问题

  **原理：** 
  1、客户端发送用户名、密码
  2、服务器端验证通过之后生成该用户的 token 并响应给客户端
  3、客户端转存 token 到 sessionStorage 中
  4、后续所有请求都携带 token
  5、服务端在根据这个 token 来判断你是哪个用户

## 例（通过请求参数携带 token）
```js
axios.interceptors.request.use(function (config) {

  -- 增
  // 为 post 请求添加 token 参数
  if (config.method === 'post' && !config.value) {
    if (config.data) {
      config.data.token = window.sessionStorage.getItem('token')
    } else {
      config.data = 'token=' + window.sessionStorage.getItem('token')
    }
  }
  // 为 get 请求添加 token 参数
  if (config.method === 'get' && config.data) {
    config.url = config.url + '&token=' + window.sessionStorage.getItem('token')
  } else if (config.method === 'get') {
    config.url = config.url + '?token=' + window.sessionStorage.getItem('token')
  }
  --

  const data = config.data
  ...
})
```

## 例（通过请求头携带 token）
```js
// 请求拦截器
axios.interceptors.request.use(config => {
  // config：请求对象
  // 为请求头对象，添加 Token 验证的 Authorization 字段
  config.headers.Authorization = window.sessionStorage.getItem('token')
  return config
})
```

## 二、在每次请求的请求头中添加 token 验证的 Authorization 字段
```js
-- main.js

axios.interceptors.request.use(config => {
  config.headers.Authorization = window.sessionStorage.getItem('token')
  return config
})
```

## 二、退出登录
**原理：** 销毁 token

```js
logout() {
  window.sessionStorage.clear()
  this.$router.push("/")
}
```