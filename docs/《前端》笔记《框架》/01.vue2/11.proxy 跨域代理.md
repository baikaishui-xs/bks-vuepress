---
title: proxy 跨域代理
date: 2022-06-27 11:01:39
permalink: /pages/8e1497/
categories:
  - 《前端》笔记《框架》
  - 1.vue2
tags:
  - 
---
vue 项目运行的地址：http://localhost:8080/
API 接口运行的地址：https://www.escook.cn/api/users

以上因为 协议、IP地址、端口号 的不同，当项目请求接口的时候，会存在跨域问题，当 API 接口没有开启 CORS 跨域资源共享，因此默认情况下，这个接口无法请求成功

方法一：开启 CORS 跨域资源共享
  缺点：需要叫后端人员开启跨域资源共享，如果后端人员没时间，则项目无法正常开发

方法二：通过 proxy 代理接口
  特性：
    1、通过 vue-cli 创建的项目在遇到接口跨域问题时，可以通过代理的方式来解决
    2、代理接口不受跨域限制
    3、proxy 代理接口，仅在开发调试阶段生效，项目上线发布时，依旧需要 API 接口服务器开启 CORS 跨域资源共享

  原理：
    （1）把 axios 的请求根路径修改为 vue 项目的运行地址（接口请求不再跨域）
    （2）vue 项目发现请求的接口不存在，把请求转交给 proxy 代理
    （3）代理把请求根路径替换为 devServer.proxy 属性的值，发起真正的数据请求
    （4）代理把请求到的数据，转发给 axios

例子：
  -- App.vue

    <button type="success" @click="getUsers">获取用户列表</button>

    methods: {
      async getUsers() {
        const {data: res} = await this.$http.get('/api/users')
        console.log(res)
      }
    }

  -- main.js

    // axios.defaults.baseURL = 'https://www.escook.cn'
    axios.defaults.baseURL = 'http://localhost:8080'  // （1）把 axios 的请求根路径修改为 vue 项目的运行地址（接口请求不再跨域）

  -- vue.config.js // （2）在项目根目录下创建 vue-config.js，并添加以下代码

    module.exports = {
      devServer: {
        proxy: 'https://www.escook.cn',  // （3）将没有匹配到静态文件的请求，代理到指定请求地址中
      }
    }