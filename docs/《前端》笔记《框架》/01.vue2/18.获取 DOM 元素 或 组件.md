---
title: 获取 DOM 元素 或 组件
date: 2022-06-27 11:01:39
permalink: /pages/29b80e/
categories:
  - 《前端》笔记《框架》
  - 1.vue2
tags:
  - 
---
作用：在不依赖于 jQuery 的情况下，获取 DOM元素 或 组件

特性：$ 开头的都是 Vue 实例的内置成员 

一、获取 DOM 元素

    方式一：ref（推荐）

        （1）获取单个元素
            使用步骤：
                1、在要获取的 DOM元素 中绑定 ref="标识符" 属性
                2、使用 this.$refs.标识符 获取 DOM元素

            <div ref="box">我是box</div>
            this.$refs.box

        （2）获取 v-for 遍历的多个元素
            使用步骤：
                1、在要获取的 DOM元素 中绑定 ref="li" 属性
                2、使用 this.$refs.li 获取 DOM元素

            <li v-for="i in 4" :key="i" ref="li">{{i}}</li>
            this.$refs.li
            // 获取遍历中的其中一个元素：this.$refs.li[下标]

    方式二：$event 参数
        使用步骤：
            1、定义 $event 参数
                <div data-index="11" click="handleClick(1, $event)">点击我试试</div>
            2、使用 event 获取 DOM元素
                methods: {
                    handleClick(index, event) {
                        console.log(event)
                    }
                }



    功能：点击按钮让 h1元素 变成红色
    使用步骤：
    （1）在要获取的 DOM元素 中绑定 ref="标识符" 属性
    （2）使用 this.$refs.标识符 获取 DOM元素

    <template>
        <div class="app-container">

            // （1）在要获取的 DOM元素 中绑定 ref="标识符" 属性
            <h1 ref="myh12">APP 根组件</h1>

            <button @click="showThis">打印 this</button>
        </div>
    </template>

    <script>
        export default {
            methods: {
                showThis() {

                    // （2）使用 this.$refs.标识符 获取 DOM元素
                    this.$refs.myh12.style.color = 'red'
                }
            }
        }
    </script>

二、获取 子组件
    原理：相当于 子组件里的 this ，都是指向 子组件
    功能：点击父组件的重置按钮，让子组件的 count 数据重置
    使用步骤：
        （1）在 子组件标签 中绑定 ref="标识符" 属性
        （2）使用 this.$refs.标识符 获取 子组件

    -- 父组件
        <template>
            <div class="app-container">
        
                // （1）在 子组件标签 中绑定 ref="标识符Ref" 属性
                <Left ref="comLeftRef"></Left>

                <button @click="onReser">重置</button>
            </div>
        </template>

    <script>
        export default {
            methods: {
                onReset() {

                    // （2）使用 this.$refs.标识符 获取 子组件
                    this.$refs.comLeftRef.resetCount()
                }
            }
        }
    </script>

    -- 子组件
        <template>
            <div class="left-container">
        
                <h3>{{ count }}</h3>

            </div>
        </template>

        <script>
            export default {
                data() {
                    return {
                        count: 8
                    }
                },
                methods: {
                    resetCount() {
                        this.count = 0
                    }
                }
            }
        </script>

常见问题
    （1）功能：页面中有一个隐藏的表单元素，默认是隐藏状态，当点击按钮时，切换显示状态，并自动对焦
        报错：TypeError: Cannot read property 'focus' of undefined
        原理：因为组件生命周期在运行阶段，当数据发送变化时，还没有立刻渲染到页面，所以获取的这个 DOM元素不存在
        解决方法：放在 this.$nextTick(回调函数) 方法中
            this.$nextTick 作用：当页面重新渲染后才会执行

        methods: {
            showInput() {
                this.inputVisible = true,
                this.$nextTick(() => {
                    this.$refs.iptRef.focus()
                })
            }
        }
        
    -- App.vue
        
        <input type="text" class="form-control" v-if="inputVisible" ref="ipt" />
        <button type="button" v-else @click="showInput">展示 input 输入框</button>

        data() {
            return {
                inputVisible: false
            }
        },
        methods: {
            showInput() {
                this.inputVisible = true
                this.$refs.ipt.focus()
            }
        }

    -- 