---
title: watch 函数
date: 2022-06-27 11:01:39
permalink: /pages/bf1d98/
categories:
  - 《前端》笔记《框架》
  - vue3
tags:
  - 
---
```
作用：定义侦听器

侦听器：当数据发送变化时触发

（1）监听 ref 数据
  语法：watch(监听的数据, (新值, 旧值) => {})

（2）监听 reactive 数据
  语法：watch(监听的数据, (新值) => {})

  deep：侦听对象中的某个属性（深度侦听）
  immediate：自动触发侦听器

（3）监听 多个数据
  语法：watch([监听的数据, 监听的数据], () => {})

（4）监听 对象中某一个属性的变化
  语法：watch(() => 监听的数据, () => {})

<template>
  <div class="container">
    <div>
      <p>count的值：{{count}}</p>
      <button @click="add">改数据</button>
    </div>
    <hr>
    <div>
      <p>{{obj.name}}</p>
      <p>{{obj.age}}</p>
      <p>{{obj.brand.name}}</p>
      <button @click="updateName">改名字</button>
      <button @click="updateBrandName">改品牌名字</button>
    </div>
  </div>
</template>

<script>
import { reactive, ref, watch } from 'vue'
export default {
  name: 'App',
  
  setup () {
    const count = ref(0)

    // （1）监听 ref 数据

      const add = () => {
        count.value++
      }

      watch(count, (newVal, oldVal) => {
        console.log(newVal, oldVal)
      })

    // （2）监听 reactive 数据

      const obj = reactive({
        name: 'ls',
        age: 10,
        brand: {
          id: 1,
          name: '宝马'
        }
      })

      const updateName = () => {
        obj.name = 'zs'
      }
      const updateBrandName = () => {
        obj.brand.name = '奔驰'
      }
      watch(obj, () => {
        console.log('数据改变了')
      })

      watch(() => obj.brand, () => {
        console.log('brand数据改变了')
      },{
        deep: true,
        immediate: true
      })

    // （3）监听 多个数据

      // watch([count, obj], () => {
      //   console.log('监听多个数据改变了')
      // }) 


    // （4）监听 对象中某一个属性的变化

      // watch(() => obj.name,() => {
      //   console.log('监听obj.name改变了')
      // })

    return {count, add, obj, updateName, updateBrandName}
  }
}
</script>
```