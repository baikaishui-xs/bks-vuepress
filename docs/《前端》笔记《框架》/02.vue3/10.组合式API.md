---
title: 组合式API
date: 2022-06-27 11:01:39
permalink: /pages/6174e6/
categories:
  - 《前端》笔记《框架》
  - vue3
tags:
  - 
---
Option API（选项 API）（Vue 2.x）
  代码风格：将功能代码写在指定位置中
  缺点：
    1、功能代码分散
    2、阅读性差
    2、维护性差
  如：实现累加功能
    1、在 data 中声明数据
    2、在 methods 声明方法
    3、将上面两步组合在一起才可以完成
  特性：如果是小功能这样写没问题，但如果是个复杂的功能，会有很多的数据很方法，如果还这样写是非常分散的

  mixins
    作用：功能封装（复用）
    缺点：数据、方法覆盖的概率很大，不好维护
      如：将 a.js 和 b.js 引入到 html 里，如果这两个 js 文件中有相同的变量和方法，就会导致覆盖


Compositon API（组合式 API）（Vue 3.x）
  代码风格：一个功能的代码组织在一起（包含数据，函数...）
  作用：解决 option API 和 mixins 的缺点

在组件中实现以两个功能：
  功能一：鼠标移动显示坐标
  功能二：点击按钮递增

  Option API 风格：

    <template>
      <div class="container">
        <div>鼠标位置：</div>
        <div>X轴：{{x}}</div>
        <div>Y轴：{{y}}</div>
        <hr>
        <div>{{count}} <button @click="add()">自增</button></div>  
      </div>
    </template>
    <script>
      export default {
        name: 'App',
        data () {
          return {
            x: 0,
            y: 0,
            count: 0
          }
        },
        mounted() {
          document.addEventListener('mousemove', this.move)
        },
        methods: {
          move(e) {
            this.x = e.pageX
            this.y = e.pageY
          },
          add () {
            this.count++
          }    
        },
        destroyed() {
          document.removeEventListener('mousemove', this.move)
        }
      }
    </script>


  Compositon API 风格：

    <template>
      <div class="container">
        <div>鼠标位置：</div>
        <div>X轴：{{x}}</div>
        <div>Y轴：{{y}}</div>
        <hr>
        <div>{{count}} <button @click="add()">自增</button></div>  
      </div>
    </template>
    <script>
      import { onMounted, onUnmounted, reactive, ref, toRefs } from 'vue'

      export default {
        name: 'App',
        setup () {

          // 累加功能
          const count = ref(0)
          const add = () => {
            count.value ++ 
          }

          // 鼠标移动功能
          const mouse = reactive({
            x: 0,
            y: 0
          })
          const move = e => {
            mouse.x = e.pageX
            mouse.y = e.pageY
          }
          onMounted(()=>{
            document.addEventListener('mousemove',move)
          })
          onUnmounted(()=>{
            document.removeEventListener('mousemove',move)
          })

          // ...功能

          // 返回数据
          return {
            ...toRefs(mouse),
            count,
            add
          }
        }
      }
    </script>