---
title: 混入 (mixin) 
date: 2022-06-27 11:01:39
permalink: /pages/d6e9fb/
categories:
  - 《前端》笔记《框架》
  - vue3
tags:
  - 
---
**文档：** https://cn.vuejs.org/v2/guide/mixins.html

# 一、作用
  ## （一）复用组件中的配置项
  ## （二）当多个组件都有相同的逻辑，没个组件都要写一次这些相同的逻辑很臃肿，mixins 可以把这些相同的逻辑抽离到一个 模块中，在混入到需要这些逻辑的组件中，实现相同的逻辑

# 二、缺点：数据、方法覆盖的概率很大，不好维护
  **如：** 将 a.js 和 b.js 引入到 html 里，如果这两个 js 文件中有相同的变量和方法，就会导致覆盖
  **解决方法：** 在 vue3.x 中可以使用 组合式API

# 三、全局混入：所有组件都拥有这些配置项
  （-- main.js）
  ```js
  import App from ./App.vue
  app.mixin({
    methods: {
      say () {
        // this.$el：组件根元素
        console.log(this.$el,'在mounted中调用say函数')
      }
    },

    // 功能：HTML结构 渲染后 执行 say 方法
    mounted () {
      this.say()
    }

  })
  ```

# 四、局部混入
  **使用步骤：**
  1、将逻辑代码写在一个模块中
  2、按需导入逻辑代码
  3、混入到组件中
  4、使用局部混入中的方法

  ## 例一
  ```js
  <script>
  const obj = {
    created() {
      alert(1)
    }
  }
  const obj1 = {
    created() {
      alert(2)
    }
  }
  export default {
    name: 'Demo',
    mixins: [obj, obj1],
    created() {
      alert(3)
    }
  }
  </script>
  ```


  ## 例二
  **需求：** 复用关注逻辑

  -- mixins.js（作用：提供逻辑）  // 1、将逻辑代码写在一个模块中

  // 功能：关注逻辑
  export const followMixin = {
    data () {
      return {
        loading: false
      }
    },
    methods: {
      followFn () {  // 作用：发送关注请求
        this.loading = true

        // 模拟请求
        setTimeout(() => {
          // ... 关注成功的逻辑
          this.loading = false
        },2000)
      }
    }
  }

  -- App.vue

    <template>
      <div class="container1">
        <h1> 作者：周杰伦  <a href="javascript:;" @click="followFn">{{loading?'正在请求...':'关注'}}</a></h1>  // 4、使用局部混入中的方法
        <hr>
        <Son />
      </div>
    </template>
    <script>
      import Son from './Son.vue'
      import { followMixin } from './mixins.js'  // 2、按需导入逻辑代码
      export default {
        name: 'App',
        components: {
          Son
        },
        mixins: [followMixin]  // 3、混入到组件中
      }
    </script>

  -- Son.vue

    <template>
      <div class="container2">
        <h2> 作者：周杰伦  <button @click="followFn">{{loading?'loading...':'关注'}}</button> </h2>  // 4、使用局部混入中的方法
      </div>
    </template>
    <script>
      import { followMixin } from './mixins.js'  // 2、按需导入逻辑代码
      export default {
        name: 'Son',
        mixins: [followMixin]  // 3、混入到组件中
      }
    </script>